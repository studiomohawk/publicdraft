<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
  <title itemprop="name" content="Grunt: A JavaScript command line build tool | Public Draft">Grunt: A JavaScript command line build tool | Public Draft | Just writing down what I've found.</title>
  <meta itemprop="description" name="description" property="og:description" content="Grunt: JavaScript用タスクベースのコマンドラインビルドツール。 concat / ファイルを結合 init / プロジェクトのscaffoldingをテンプレートから作成 lint / JSHintを利用したバリデーション min / UglifyJSによる圧縮 qunit / QUnitによるテストをヘッドレスPhantomJSを利用して実行 server / ウェブサーバを立ち上げる test / nodeunitを利用したユニットテストを実行 watch /...">
	<meta property="og:type" content="article">
	<meta property="og:url" content="">
	
  <meta property="og:image" content="http://publicdraft.studiomohawk.com/graph.png">
  <meta property="og:site_name" content="Public Draft | Just writing down what I've found.">
  <meta name="viewport" content="width=device-width">
  <link href="http://publicdraft.studiomohawk.com/atom.xml" rel="alternate" title="Public Draft | Just writing down what I've found." type="application/atom+xml">
  <link rel="stylesheet" href="/asset/style/style.css">
</head>
<body>

<div id="page" class="page page-post">
<header class="the-header">
<div class="unit unit-logo">
	<div class="unit-inner">
		<div class="mod">
			<div class="inner">
				<div class="hd"><p id="logo" class="logo"><a href="/"><span class="logo-public">public</span><span class="logo-ja">draft</span></a></p></div>
			</div><!-- inner -->
		</div><!-- mod -->
	</div><!-- unit-inner -->
</div><!-- unit -->
</header>


<div role="main" class="body">
<div class="unit">
<div class="unit-inner">
<article class="the-article hentry">
	<div class="mod">
		<div class="inner">
			<div class="hd">
				<div class="group group-title">
				<h1 class="h2 post-title">Grunt: A JavaScript command line build tool</h1>
				<p class="byline">Written by: Yuya Saito</p>
				
				<time class="date-pub pubdate small" title="2012-05-20T21:14:24+09:00">
					<span class="label">Published: </span>
					<span class="month">May</span>
					<span class="day">20</span>
					<span class="year">2012</span>
				</time>
				</div><!-- group -->
			</div>
			<div class="bd">
				<div class="content">
					<p>Grunt: JavaScript用タスクベースのコマンドラインビルドツール。  </p>

<ul>
  <li><code>concat</code> / ファイルを結合</li>
  <li><code>init</code> / プロジェクトのscaffoldingをテンプレートから作成</li>
  <li><code>lint</code> / <a href="http://www.jshint.com/">JSHint</a>を利用したバリデーション</li>
  <li><code>min</code> / <a href="https://github.com/mishoo/UglifyJS/">UglifyJS</a>による圧縮</li>
  <li><code>qunit</code> / <a href="http://docs.jquery.com/QUnit">QUnit</a>によるテストをヘッドレス<a href="http://phantomjs.org/">PhantomJS</a>を利用して実行</li>
  <li><code>server</code> / ウェブサーバを立ち上げる</li>
  <li><code>test</code> / <a href="https://github.com/caolan/nodeunit">nodeunit</a>を利用したユニットテストを実行</li>
  <li><code>watch</code> / 監視対象のファイルに変更があった場合にタスクを実行する</li>
</ul>

<p><a href="https://github.com/cowboy/grunt">github</a></p>

<h2>インストール</h2>

<p><code>npm install -g grunt</code><br />
<code>qunit</code>タスク用にPhantomJSが必要になるがnpmからはインストールができないため、
<code>brew install phantomjs</code>と<code>brew</code>でインストールする。</p>

<h2>使い方</h2>

<p>gruntは実行したディレクトリ内の<code>grunt.js</code>というファイルを検索、なければ親ディレクトリと見つけるまで継続して検索し続ける。<br />
<code>grunt.js</code>にはプロジェクトの設定、呼び出すgruntのプラグインやタスクフォルダの設定、タスク、ヘルパそのものを記述する。</p>

<p><strong>ベーシックなgrunt.jsファイルの例</strong></p>

<div class="highlight"><pre><code class="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// プロジェクトの設定</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">lint</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">all</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;grunt.js&#39;</span><span class="p">,</span> <span class="s1">&#39;lib/**/*.js&#39;&#39;test/**/*.js&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">jshint</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">browser</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="c1">// 呼び出すgruntのプラグインやタスクフォルダの設定</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-sample&#39;</span><span class="p">);</span>

  <span class="c1">// デフォルトタスク</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;lint sample&#39;</span><span class="p">);</span>

<span class="p">};</span>
</code></pre>
</div>

<p><a href="https://github.com/cowboy/grunt-jquery-example/blob/master/grunt.js">あらかじめ設定されているjQueryプロジェクトのgrunt.js例</a></p>

<h2>プラグイン</h2>

<ul>
  <li><a href="https://github.com/gruntjs/grunt-contrib">grunt-contrib</a></li>
</ul>

<p>gruntによく使うタスクを追加する。</p>

<ul>
  <li><code>clean</code> / ファイル、フォルダを削除</li>
  <li><code>coffee</code> / CoffeeScriptをJavaScriptにコンパイル</li>
  <li><code>handlebars</code> / handlebarsのテンプレートをコンパイル</li>
  <li><code>jade</code> / jadeテンプレートをHTMLにコンパイル</li>
  <li><code>jst</code> / underscoreのテンプレートをコンパイル</li>
  <li><code>less</code> / lessファイルをCSSにコンパイル</li>
  <li><code>mincss</code> / CSSを圧縮</li>
  <li><code>stylus</code> / StylusファイルをCSSにコンパイル</li>
  <li><code>zip</code> / ファイル、フォルダをzip圧縮</li>
</ul>

<p>インストール: <code>npm install grunt-contrib</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-contrib');</code></p>

<ul>
  <li><a href="https://github.com/backbone-boilerplate/grunt-bbb">backbone-boilerplate/grunt-bbb</a></li>
</ul>

<p>Backbone Boilerplateフレームワークツール。</p>

<p>インストール: <code>npm install -g bbb</code><br />
使い方: <code>bbb init</code></p>

<ul>
  <li><a href="https://github.com/jzaefferer/grunt-css">grunt-css</a></li>
</ul>

<p><code>cssmin</code>、<code>csslint</code>という2つのタスクを追加できる。</p>

<p>インストール: <code>npm install grunt-css</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-css');</code></p>

<ul>
  <li><a href="https://github.com/sindresorhus/grunt-recess">grunt-recess</a></li>
</ul>

<p>Twitterが採用しているスタイルガイドチェッカ<a href="https://github.com/twitter/recess">recess</a>を利用出来る。</p>

<p>インストール: <code>npm install grunt-recess</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-recess');</code></p>

<p><strong>lint、LESSのコンパイル、結合タスクの例</strong></p>

<div class="highlight"><pre><code class="js"><span class="nx">recess</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;src/main.css&#39;</span><span class="p">,</span>
            <span class="s1">&#39;src/component.css&#39;</span>
        <span class="p">],</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;dist/combined.css&#39;</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">compile</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<ul>
  <li><a href="https://github.com/asciidisco/grunt-requirejs">grunt-requirejs</a></li>
</ul>

<p><a href="http://requirejs.org/">Require.js</a>をgruntでビルドするタスクを追加。<code>r.js</code>オプティマイザーの利用も可。</p>

<p>インストール: <code>npm install grunt-requirejs</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-requirejs');</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">requirejs</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dir</span><span class="o">:</span> <span class="s1">&#39;build&#39;</span><span class="p">,</span>
  <span class="nx">appDir</span><span class="o">:</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span>
  <span class="nx">baseUrl</span><span class="o">:</span> <span class="s1">&#39;js&#39;</span><span class="p">,</span>
  <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">underscore</span><span class="o">:</span> <span class="s1">&#39;../vendor/underscore&#39;</span><span class="p">,</span>
      <span class="nx">jquery</span>    <span class="o">:</span> <span class="s1">&#39;../vendor/jquery&#39;</span><span class="p">,</span>
      <span class="nx">backbone</span>  <span class="o">:</span> <span class="s1">&#39;../vendor/backbone&#39;</span>
  <span class="p">},</span>
  <span class="nx">pragmas</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">doExclude</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nx">skipModuleInsertion</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">optimizeAllPluginResources</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">findNestedDependencies</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
</div>

<ul>
  <li><a href="https://github.com/jharding/grunt-less">grunt-less</a></li>
</ul>

<p>LESSをCSSにコンパイル。</p>

<p>インストール: <code>npm install grunt-less</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-less');</code></p>

<ul>
  <li><a href="https://github.com/jharding/grunt-exec">grunt-exec</a></li>
</ul>

<p>Gruntからシェルコマンドを実行。</p>

<p>インストール: <code>npm install grunt-exec</code><br />
タスクのロード: <code>grunt.loadNpmTasks('grunt-exec');</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">exec</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">remove_logs</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">command</span><span class="o">:</span> <span class="s1">&#39;rm -f *.log&#39;</span>
        <span class="p">}</span>
        <span class="nx">list_files</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">command</span><span class="o">:</span> <span class="s1">&#39;ls -l **&#39;</span><span class="p">,</span>
            <span class="nx">stdout</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>

<ul>
  <li><a href="https://github.com/webxl/grunt-reload">grunt-reload</a></li>
</ul>

<p>gruntnのデフォルト<code>watch</code>タスクで指定したファイルの変更に合わせてブラウザのリロードを行う。</p>

<p>インストール: <code>npm install grunt-reload</code>
タスクのロード: <code>grunt.loadNpmTasks('grunt-reload');</code></p>

<ul>
  <li><a href="https://github.com/pifantastic/grunt-s3">grunt-s3</a></li>
</ul>

<p>Amazon S3 アップロード/ダウンロード。</p>

<p>インストール: <code>npm install grunt-s3</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>

  <span class="nx">s3</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;YOUR KEY&#39;</span><span class="p">,</span>
    <span class="nx">secret</span><span class="o">:</span> <span class="s1">&#39;YOUR SECRET&#39;</span><span class="p">,</span>
    <span class="nx">bucket</span><span class="o">:</span> <span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span>
    <span class="nx">access</span><span class="o">:</span> <span class="s1">&#39;public-read&#39;</span><span class="p">,</span>

    <span class="c1">// Files to be uploaded.</span>
    <span class="nx">upload</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;important_document.txt&#39;</span><span class="p">,</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;documents/important.txt&#39;</span><span class="p">,</span>
        <span class="nx">gzip</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;passwords.txt&#39;</span><span class="p">,</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;documents/ignore.txt&#39;</span><span class="p">,</span>

        <span class="c1">// These values will override the above settings.</span>
        <span class="nx">bucket</span><span class="o">:</span> <span class="s1">&#39;some-specific-bucket&#39;</span><span class="p">,</span>
        <span class="nx">access</span><span class="o">:</span> <span class="s1">&#39;authenticated-read&#39;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="c1">// Wildcards are valid *for uploads only* until I figure out a good implementation</span>
        <span class="c1">// for downloads.</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;documents/*.txt&#39;</span><span class="p">,</span>

        <span class="c1">// But if you use wildcards, make sure your destination is a directory.</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;documents/&#39;</span>
      <span class="p">}</span>
    <span class="p">],</span>

    <span class="c1">// Files to be downloaded.</span>
    <span class="nx">download</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;documents/important.txt&#39;</span><span class="p">,</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;important_document_download.txt&#39;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;garbage/IGNORE.txt&#39;</span><span class="p">,</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;passwords_download.txt&#39;</span>
      <span class="p">}</span>
    <span class="p">],</span>

    <span class="nx">del</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;documents/launch_codes.txt&#39;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;documents/backup_plan.txt&#39;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
</div>


				</div>
			</div>
		</div><!-- inner -->
	</div><!-- mod -->
</article>
</div><!-- unit-inner -->
</div><!-- unit -->
<div class="unit unit-nav">
	<div class="unit-inner">
			<div class="bd">
				<div class="group">
					<nav class="page-nav">
					<ul>
						
						<li class="old"><a class="internal" rel="prev" href="/research/2012/04/14/01-02-sublimetext2/" title="Sublime Text 2">&larr;</a></li>
						
						
						<li class="new"><a class="internal" rel="next" href="/research/2012/07/16/docpad/" title="DocPad">&rarr;</a></li>
						
						</ul>
					</nav><!-- /.page-nav-bottom -->
				</div><!-- group -->
			</div>
	</div>
</div>
</div><!-- body -->

<footer class="the-footer">
<div class="unit">
	<div class="unit-inner">
	
		<div class="mod mod-home">
		<div class="inner">
			<div class="bd">
				<p><a href="/" class="has-icon"><i class="icon-home"></i> Home</a></p>
			</div>
		</div><!-- inner -->
	</div><!-- mod -->

	
	<div class="mod mod-question">
	<div class="inner">
		<div class="hd">
			<h4 class="h2">Questions?</h4>
		</div>
		<div class="bd">
			<p>
			<a class="has-icon" href="https://github.com/studiomohawk/en.ja/issues/new">
				<i class='icon-github'></i> Ask Me on Github
      </a>
			</p>
		</div>
	</div><!-- inner -->
</div><!-- mod -->

	<div class="mod mod-about">
	<div class="inner">
		<div class="hd">
			<h4 class="h2">About</h4>
		</div>
		<div class="bd">
			<p>
			現役フロントエンドデベロッパ/ウェブデザイナ、斉藤祐也がフロントエンドにまつわる情報やTipsを紹介。2〜3年は遅れているという日本のウェブをアップデートしたい。そんな思いで更新していきます。
			</p>
			<p>
			CSS Radarでは記事を短編の技術書のように編集して、記事はすべて可能な限り最新の情報にアップデートをしています。フロントエンドデベロッパが立ち向かわなければいけない問題への解決はGoogleで検索すればすぐに見つかる時代。そこでCSS Radarでは私なりのベストプラクティスを集めていく事を編集方針としています。
			</p>
			<p>
			最新の情報については、<a href="https://twitter.com/intent/user?user_id=107867741">Twitter@cssradar</a>にて紹介しています。</p>
		</div>
	</div><!-- inner -->
</div><!-- mod -->

	<div class="mod mod-elsewhere">
	<div class="inner">
		<div class="hd">
			<h4 class="h2">Elsewhere</h4>
		</div>
		<div class="bd">
			<ul class="list-square">
				<li><a href="http://twitter.com/#!/cssradar" rel="me" title="cssradar@twitter">cssradar@twitter</a> / 1日5件以内でフロントエンドな情報を共有</li>
				<li><a href="http://seven.studiomohawk.com/" rel="me" title="Seven">Seven</a> / フロントエンドブックマーク</li>
				<li><a href="http://enja.studiomohawk.com/" rel="me" title="en.ja">en.ja</a> / フロントエンダのための翻訳記事</li>
				<li><a href="http://publicdraft.studiomohawk.com/" rel="me" title="Public Draft">Public Draft</a> / フロントエンド・リサーチログ</li>
				<li><a href="https://github.com/studiomohawk" rel="me" title="github">github</a> / このブログのソースも公開してます</li>
				<li><a href="http://pinboard.in/u:studiomohawk" rel="me" title="Pinboard">Pinboard</a> / カオスにならないようきちんとモニタ</li>
				<li><a href="http://500px.com/studiomohawk/photos" rel="me" title="500px">500px</a> / 趣味は写真。Nikon D90ユーザ</li>
			</ul>
		</div>
	</div><!-- inner -->
</div><!-- mod -->

	<p class="madeintokyo">
	Build by Yuya Saito. <a href="https://twitter.com/cssradar" rel="me" title="Twitter@cssradar">@cssradar</a><br>
	Made Proudly in Tokyo.
	</p>
	</div><!-- unit-inner -->
</div><!-- unit -->
</footer>

</div><!-- #page -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="/asset/script/script.js"></script>
<!-- end scripts -->
<script>
var _gaq=[['_setAccount','UA-61203-19'],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
</body>
</html>

